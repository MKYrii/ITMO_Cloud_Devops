# Отчет по 1 лабораторной

## Задание
Настроить nginx по заданному тз:
* Должен работать по https c сертификатом
* Настроить принудительное перенаправление HTTP-запросов (порт 80) на HTTPS (порт 443) для обеспечения безопасного соединения.
* Использовать alias для создания псевдонимов путей к файлам или каталогам на сервере.
* Настроить виртуальные хосты для обслуживания нескольких доменных имен на одном сервере.

## Выполнили:
* Михайлов Юрий
* Норкина Ярослава
* Христофоров Владислав

# Ход работы
## Установка nginx
Мы работаем на виртуальной машине Ububtu, потому что сервер арендовать дорого и сложно...
Для начала нам необходимо установить nginx

`sudo apt-install nginx`

![image](https://github.com/user-attachments/assets/b5c79fd3-a175-4e47-9d7d-2f6aee101852)

Затем можно проверить, что наш nginx действительно заработал

![365443136-35386db8-95aa-40ef-bf2f-b9423dbdf56a](https://github.com/user-attachments/assets/11d4917f-d3cd-46b1-878c-372ce3c919f9)

После этого нам необходимо создать папки для наших проектов в нужной директории

`mkdir -p /var/www/project1.local/html`

![image](https://github.com/user-attachments/assets/1ddaddd5-a3ec-4b8f-b07d-6797fa97037f)

Теперь нужно создать файлы, которые будут представлять наши проекты - index.html. В них добавим простые теги с заголвками.

![image](https://github.com/user-attachments/assets/b1f673e6-aa0f-4b19-865c-ccff8f82a96a)

![image](https://github.com/user-attachments/assets/cebc1921-1ecf-4d7c-916a-7395fb3740c1)

## Переходим непосредственно к настройке конфигураций nginx

Для этого необходимо создать файлы конфигураций для каждого проекта и в нем прописать, что мы будем слушать порт 80, и затем перенаправлять запрос на 443 (https). Здесь мы указываем имя сервера и пути до будущих ssl сертификатов, а также говорим, где будут храниться наши проекты. Это мы делаем для обоих проектов отдельно.

![image](https://github.com/user-attachments/assets/b8b81b6a-6821-421a-a45a-b22329075167)

Затем нам необходимо активоровать наши сайты, связав их с `sites-enabled`:

![image](https://github.com/user-attachments/assets/513ee10c-6e73-4e75-96d5-5d3623cf1c96)

## Генерация SSL ключей

Так как мы все даелаем сами, сертификаты у нас тоже будут самоподписанные: для их генерации пользуемся длинной командой, которую нашли в гайдах в интернете.

![image](https://github.com/user-attachments/assets/a82197c3-6d40-41a2-937e-7c281926fb28)

![image](https://github.com/user-attachments/assets/feb079df-455a-4989-9de4-2de70cc9a23f)

P.s. - на скриншотах оба сертификата отправляются в /private, хотя на самом деле в нашем случае файлы .crt были перенесены в папку /certs

## Добавление хостов

Чтобы наши хосты были видны локально, в файле `etc/hosts` необходимо добавить их на локальный домен 127.0.0.1

![image](https://github.com/user-attachments/assets/cadc33a8-71b3-4e08-9b1b-94223ccc79be)


## Проверка

Теперь мы готовы к тестированию наших сайтов. Для этого сначала проверяем синтаксис nginx командой `sudo nginx -t`, а затем перезагружаем nginx при помощи `sudo systemctl restart nginx`.

![image](https://github.com/user-attachments/assets/cc002697-f557-4d48-960b-87f61f9e69ba)

![image](https://github.com/user-attachments/assets/d2c282c6-f19c-4af2-9337-547d14f5c4c7)


Теперь если в браузере перейти на project1.local или project2.local, мы действительно увидим то, что писали в HTML файлах.

![image](https://github.com/user-attachments/assets/816993e0-e388-4a1b-8385-21123cfa8d54)

Важно отметить, что мы подключились по протоколу https (это видно в строке поиска).

## Настройка alias

Alias нужен, чтобы мы могли создавать псевдонимы к папкам, которые использует наш проект, и которые могут находиться в других местах. Например, если мы попробуем обратиться к project2.local/media, у нас ничего не выйдет.

![image](https://github.com/user-attachments/assets/181e75a7-54ef-4008-bc37-94e3fad9ed5e)

Чтобы это исправить, нам нужно немного изменить файл конфигурации сайта:

![image](https://github.com/user-attachments/assets/e7541bc1-d944-46a2-9e17-fba5e6341e58)

Для project1.local действия аналогичны

## Итог

Теперь мы настроили alias и нам доступно содержимое папок media в наших проектах

![image](https://github.com/user-attachments/assets/28e6f15d-6a09-42bb-b0ff-6b6237ad4136)

![image](https://github.com/user-attachments/assets/a8eae3ed-a6ad-4bbf-ae0c-08ffa6d4258f)


## Вывод

Мы провели достаточно большую работу, в ходе которой смогли разобраться со многими тонкостями работы серверов и их настройки, а также отточили навыки раоты в консоли Linux.

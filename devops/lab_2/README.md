# DevOps

## Лабораторная №2

>
> ### Задание
>
> Написать “плохой” Dockerfile, в котором есть не менее трех “bad practices” по написанию докерфайлов
>

Напишем Dockerfile

```python
    # Плохой Dockerfile

    # Использование конкретного, но устаревшего базового образа
    FROM python:3.7

    # Выполнение множества команд RUN без объединения (создаёт лишние слои)
    RUN apt-get update
    RUN apt-get install -y git
    RUN apt-get install -y curl

    # Указание рабочей директории
    WORKDIR /bad_docker

    # Использование ADD вместо COPY для простого копирования файлов (лишние возможности, которые могут привести к ошибкам)
    ADD . .

    # Установка зависимостей без кэширования и оптимизации (вместо установки зависимостей перед копированием кода)
    RUN pip install --no-cache-dir -r requirements.txt

    # Хранение конфиденциальной информации в слоях (например, токен или пароль)
    RUN echo "SECRET_TOKEN=12345" >> /bad_docker/app/.env

    # Запуск от root пользователя (небезопасно)
    CMD ["python", "app/app.py"]
```

Таким образом, Dockerfile содержит следующие плохие практики:
1. Использование конкретного, но ***устаревшего базового образа***

1. Выполнение множества команд ***RUN без объединения***. Рекомендуется объединить все команды в одну инструкцию и разделить её
 символами разрыва строки с помощью символа \. Благодаря такому подходу файлы будут выглядеть аккуратно и это приведёт к
добавлению в образ меньшего количества слоёв, чем было бы добавлено при использовании нескольких инструкций RUN.

1. Использование ***ADD вместо COPY*** для простого копирования файлов. Инструкция ADD позволяет решать те же задачи, что и COPY,
но с ней связаны ещё пара вариантов использования. Документация предлагает везде, где это возможно, вместо инструкции ADD
использовать инструкцию COPY для того, чтобы сделать файлы Dockerfile понятнее.

1. Установка зависимостей без кэширования и оптимизации (вместо установки зависимостей перед копированием кода)

1. Хранение конфиденциальной информации в слоях, например, токен или пароль

2. Запуск от ***root пользователя***
   
***

-	Запуск плохого контейнера 
*скриншот*
 
-	При сборке получаем следующее предупреждение:
*скриншот*
 
Т.е. образ для контейнера создается, его можно использовать, но даже на уровне компилятора мы получаем указание на одну из неправильных
практик в написании docker-файла. 
«ВНИМАНИЕ: запуск pip от имени пользователя root может привести к нарушению разрешений и конфликтному поведению с системным менеджером 
пакетов. Вместо этого рекомендуется использовать виртуальную среду: https://pip.pypa.io/warnings/venv.»

-	Сборка занимает _с,  _Гб
*скриншот*

- Получаем образ контейнера, который можно посмотреть в программе Docker Desktop
*скриншот*

- Создается контейнер
*скриншот*


>
> ### Задание
>
> Написать “хороший” Dockerfile, в котором эти плохие практики исправлены
>

Исправим Dockerfile

```python

```

***




>
> ### Задание
>
> Описать как исправление плохих практик повлияло на результат
>
>

Видимо должна увеличится скорость сборки контейнера и уменьшится размер образа. Компилятор не кидает предупреждение и сам образ стал более безопасным,
простым в использовании.
Хорошая практика — это создание предсказуемых и безопасных контейнеров, с минимальными слоями, точными версиями зависимостей и отсутствием лишних файлов.
Это улучшает производительность, снижает размер образа и повышает стабильность развертывания.


***

>
> ### Задание
>
> В Readme описать 2 плохих практики по работе с контейнерами. 
>

- Настройте централизованное логирование, чтобы собирать логи из контейнеров и облегчить их анализ.
- Какая-то вторая

